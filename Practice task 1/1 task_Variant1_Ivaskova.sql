USE Sample;
GO

-- ==========================================
-- «ј¬ƒјЌЌя 1
-- ќтримати назви та номери вс≥х в≥дд≥лень, що знаход€тьс€ у ƒаллас≥
-- ==========================================
SELECT dept_name, dept_no
FROM department
WHERE location = 'Dallas';
GO

-- ==========================================
-- «ј¬ƒјЌЌя 2
-- ќтримати ≥мена, пр≥звища та номери прац≥вник≥в,
-- у €ких друга л≥тера ≥мен≥ Ђaї
-- ==========================================
SELECT emp_fname, emp_lname, emp_no
FROM employee
WHERE emp_fname LIKE '_a%';
GO

-- ==========================================
-- «ј¬ƒјЌЌя 3
-- ќтримати вс≥ дан≥ про п≥дрозд≥ли,
-- де м≥сце розташуванн€ починаЇтьс€ з символу в д≥апазон≥ в≥д B до M
-- ==========================================
SELECT *
FROM department
WHERE location LIKE '[B-M]%';
GO

-- ==========================================
-- «ј¬ƒјЌЌя 4
-- ќтримати номери прац≥вник≥в, €к≥ працюють над проектом p1 або проектом p2
-- ==========================================
SELECT DISTINCT emp_no
FROM works_on
WHERE project_no IN ('p1','p2');
GO

-- (додатково, €кщо потр≥бно пр≥звища)
-- SELECT DISTINCT w.emp_no, e.emp_lname, e.emp_fname
-- FROM works_on w
-- JOIN employee e ON e.emp_no = w.emp_no
-- WHERE w.project_no IN ('p1','p2');
-- GO

-- ==========================================
-- «ј¬ƒјЌЌя 5
-- ќтримати список р≥зних роб≥т по кожному проекту
-- ==========================================
SELECT DISTINCT project_no, job
FROM works_on;
GO

-- ¬ар≥ант ≥з групуванн€м (€кщо дозволено):
-- SELECT project_no, STRING_AGG(DISTINCT job, ', ') AS jobs
-- FROM works_on
-- GROUP BY project_no;
-- GO

-- ==========================================
-- «ј¬ƒјЌЌя 6
-- ќтримати назви проект≥в ≥з бюджетом меншим н≥ж 100000
-- або б≥льшим н≥ж 150000
-- ==========================================
SELECT project_name
FROM project
WHERE budget < 100000 OR budget > 150000;
GO

-- ==========================================
-- «ј¬ƒјЌЌя 7
-- ќтримати назви та бюджети проект≥в з бюджетом у д≥апазон≥
-- в≥д 75000 до 100000 включно
-- ==========================================
SELECT project_name, budget
FROM project
WHERE budget BETWEEN 75000 AND 100000;
GO

-- ==========================================
-- «ј¬ƒјЌЌя 8
-- ќтримати назви проект≥в ≥з бюджетом б≥льшим н≥ж 60000 фунт≥в стерл≥нг≥в
-- (курс 1 долар = 0.51 фунта)
-- ==========================================
SELECT project_name
FROM project
WHERE budget * 0.51 > 60000;
GO

-- ==========================================
-- «ј¬ƒјЌЌя 9
-- ќтримати номер та пр≥звище прац≥вника з найменшим номером
-- ==========================================
SELECT TOP 1 emp_no, emp_lname
FROM employee
ORDER BY emp_no ASC;
GO

-- ==========================================
-- «ј¬ƒјЌЌя 10
-- ќтримати пр≥звища та ≥мена вс≥х прац≥вник≥в,
-- з номером прац≥вника б≥льшим або р≥вним 15000
-- ==========================================
SELECT emp_lname, emp_fname
FROM employee
WHERE emp_no >= 15000;
GO

-- ==========================================
-- «ј¬ƒјЌЌя 11
-- ќтримати номери, ≥мена та пр≥звища вс≥х прац≥вник≥в,
-- чињ пр≥звища не починаютьс€ з л≥тер J, K, L, M, N, O
-- ≥ чињ ≥мена не починаютьс€ з л≥тер E або Z
-- ==========================================
SELECT emp_no, emp_fname, emp_lname
FROM employee
WHERE emp_lname NOT LIKE '[JKLMNO]%'
  AND emp_fname NOT LIKE '[EZ]%';
GO

-- ==========================================
-- «ј¬ƒјЌЌя 12
-- ќтримати вс≥ дан≥ про роботи, що почалис€ у 2007 роц≥
-- ==========================================
SELECT *
FROM works_on
WHERE YEAR(enter_date) = 2007;
-- або:
-- WHERE enter_date >= '2007-01-01' AND enter_date < '2008-01-01';
GO